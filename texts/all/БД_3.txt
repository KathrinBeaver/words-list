3. ВВОД И РЕДАКТИРОВАНИЕ ДАННЫХ С 
ПОМОЩЬЮ ФОРМ
В СУБД Access для просмотра, ввода и редактирования данных используются формы, являющиеся наиболее наглядным средством представления информации. Они также используются как кнопочные формы, открывающие другие формы или отчеты базы данных, а также как пользовательское диалоговое окно для ввода данных и выполнения действий, определяемых введенными данными.
Связь между формой и ее источником записей создается при по-мощи графических объектов, которые называют элементами управ-ления. Элемент управления – это объект графического интерфейса пользователя (такой как поле, флажок, полоса прокрутки или кнопка), позволяющий пользователям управлять приложением. Элементы управления используются для отображения данных или па-раметров, для выполнения действий, либо для упрощения работы с интерфейсом пользователя. 
Форму можно создать тремя различными способами:
1)	при помощи  Мастера Автоформы на основе таблицы или за-проса;
2)	при помощи Мастера на основе одной или нескольких таблиц или запросов;
3)	вручную в режиме Конструктора.
С помощью автоформ можно создавать формы, в которых выво-дятся все поля и записи базовой таблицы или запроса. Если выбранный источник записей имеет связанные таблицы или запросы, то в форме также будут присутствовать все поля и записи этих источников записей.
Мастер задает подробные вопросы об источниках записей, полях, макете, требуемых форматах и создает форму на основании полученных ответов.
В режиме конструктора сначала создается базовая форма, которая затем изменяется в соответствии с требованиями.
3.1. Создание простых форм для одной и двух связанных таблиц 
3.1.1. Мастер Автоформы
Чтобы быстро создать простую однотабличную форму, можно воспользоваться Мастером Автоформы. Для примера создадим форму для таблицы  Данные о врачах: 
1.	В окне базы данных выберите Формы в списке Объекты.
2.	Нажать кнопку Создать на панели инструментов окна базы данных.
3.	В диалоговом окне Новая форма необходимо выбрать тре-буемую автоформу (рис. 3.1).
 
Рис. 3.1. Диалоговое окно для задания типа создаваемой формы
1)	Автоформа: в столбец.   Каждое поле располага-ется на отдельной строке; подпись находится слева от поля.
2)	Автоформа: ленточная.   Поля, образующие одну запись, расположены в одной строке; их подписи выводятся один раз в верхней части формы.
3)	Автоформа: табличная.   Поля записей располо-жены в формате таблицы, где каждой записи соответствует одна строка, а каждому полю один столбец. Имена полей служат заголовками столбцов.
4)	Автоформа: сводная таблица.   Форма открыва-ется в режиме сводной таблицы. Имеется возможность до-бавлять поля путем их перетаскивания из списка полей в различные области макета.
5)	Автоформа: сводная диаграмма.   Форма откры-вается в режиме сводной диаграммы. Имеется возможность добавлять поля путем их перетаскивания из списка полей в различные области макета.
Выберите Автоформа: в столбец  и укажите в качестве источника данных таблицу Данные о врачах.
4.	После нажатия кнопки ОК появится окно формы (рис. 3.2).
 
Рис. 3.2. Форма,  созданная с помощью Мастера Автоформы
Microsoft Access применяет к форме автоформат, который использо-вался последним. Если до этого формы с помощью мастера не созда-вались и не использовалась команда Автоформат в меню Формат, будет применяться стандартный автоформат.
Чтобы изменить автоформат уже созданной формы в режиме конструктора форм выберите в меню Формат команду Автоформат. Появится окно, с помощью которого можно изменить тип формы.
3.1.2. Создание форм с помощью Мастера
	В отличие от Мастера Автоформы  Мастер форм позволяет создавать формы как для одиночных, так и для связанных таблиц, а также настраивать поля, стиль их отображения, тип кнопок управления, размещаемых в форме.
Для примера создадим форму для таблицы Данные о пациентах.
1.	В окне базы данных выберите Формы в списке Объекты.
2.	Нажмите кнопку Создать на панели инструментов.
3.	В диалоговом окне Новая форма выберите нужного мастера.
Описание мастера появляется в левой части диалогового окна.
4.	Выберите имя таблицы Данные о пациентах.
Примечание. Этот шаг не обязателен — источник записей для формы можно указать позднее.
5.	Нажмите кнопку OK. Появится окно «Создание форм» (Рис. 3.3).
Примечание. Можно  выбрать Создание формы с помощью мас-тера непосредственно в окне базы данных. В итоге также появится  окно «Создание форм».
6.	Далее необходимо выбрать имя таблицы, если оно не было указано раннее, и  требуемые поля формы.
7.	В следующем окне необходимо выбрать тип формы.
8.	Затем указать стиль.
9.	В заключение мастер попросит указать имя формы и дальнейшие действия. Нажмите кнопку Готово. В итоге появится окно, изо-бражённое на рис.4.
Создадим форму для таблиц Данные о пациентах и Данные о посещении врачей пациентами.

 
Рис. 3.3. Диалоговое окно для задания полей формы
 
Рис. 3.4. Форма,  созданная с помощью мастера
Перед этим установим связь между одноимёнными полями таблиц Уникальный идентификатор пациента «один-ко-многим». Таким образом одной записи в таблице Данные о пациентах может со-ответствовать несколько записей в таблице Данные о посещении врачей пациентам.
Для вывода данных из таблиц, связанных с отношением «один-ко-многим», особенно удобны подчиненные формы.
Подчиненной формой называют форму, вставленную в другую форму. Первичная форма называется главной формой, а форма внутри формы называется подчиненной формой. Комбинацию «фор-ма/подчиненная форма» часто называют также иерархической формой или комбинацией «родительской» и «дочерней» форм.
Главная форма и подчиненная форма в этом типе форм связаны таким образом, что в подчиненной форме выводятся только те записи, которые связаны с текущей записью в главной форме.
1.	В окне базы данных в списке Объекты выберите Формы.
2.	На панели инструментов окна базы данных нажмите кнопку Соз-дать.
3.	В диалоговом окне Новая форма дважды щелкните строку Мас-тер форм.
4.	В первом диалоговом окне мастера выберите в списке таблицу Данные о пациентах.
Примечание.   Порядок выбора таблицы не имеет значения.
5.	Дважды щелкните поля таблицы или запроса, которые нужно включить в форму.
6.	В том же диалоговом окне мастера выберите из списка другую таблицу (Данные о посещении врачей пациентами).
7.	Дважды щелкните поля таблицы или запроса, которые нужно включить в форму.
8.	Если до запуска мастера отношения установлены правильно, то после нажатия кнопки Далее мастер предложит выбрать таблицу или запрос, используемые для представления данных.
9.	В том же диалоговом окне выберите переключатель Подчинен-ные формы (рис.х 3.5). 
10. Следуйте инструкциям остальных диалоговых окон мастера. По-сле нажатия кнопки Готово Microsoft Access создаст две формы: одну для главной формы и элемента управления «Подчиненная форма», а другую для подчиненной формы.

 
Рис. 3.5. Диалоговое окно для выбора вида представления данных
    В итоге получится форма, изображённая на рис. 3.6. Обратите внимание, что в подчинённой форме выводятся несколько записей.
 
Рис. 3.6. Главная и подчинённая формы
3.2. Главная кнопочная форма
После создания форм для таблиц и запросов было бы логичным сделать форму для управления всей базой данных. Такая форма назы-вается Главной кнопочной формой. 
Создание Главной кнопочной формы базы данных:
1.	Найдите в базе данных формы, которые Вы создали, но не от-крывайте их. Откройте меню Сервис, переместите указатель мыши на строку Служебные программы и в дополнительном меню которое появится справа, щелкните по строке Диспетчер кнопочных форм.
2.	Увидев сообщение «Не удается найти кнопочную форму в этой базе данных. Создать кнопочную форму?», щелкните по кнопке «ОК». Появится окно диспетчера кнопочных форм (Рис. 3.7).
3.	Создайте страницы кнопочной формы. Для этого щелк¬ните по кнопке Создать и напишите название новой стра¬ницы (Рис. 3.8). 
Затем щелкните по кнопке ОК. Повторите эти дейст¬вия столько раз, сколько страниц будет содержать кнопочная форма. Информация в Главной кнопочной форме располагается на страницах. Конечно, можно обойтись и одной страницей, но лучше отделить таблицы от за-просов, а запросы от отчетов. Кроме того, к некоторым объектам ба- зы данных обращаются часто, к другим — довольно редко. Итак, создадим следующие страницы главной кнопочной формы:
* Главная кнопочная форма (создается по умолчанию)
*  Новая информация (для ввода новых данных в базу)
*  Просмотр информации (чтобы увидеть, что хранится в базе)
*  Выход (для выхода из приложения)
4.  Щелкните по строке Главная кнопочная форма и затем — по кнопке Изменить.
5.  В окне диалога Изменение страницы кнопочной фор¬мы щелкните по кнопке Создать (Рис. 3.9).
 
Рис. 3.7. Окно диспетчера кнопочных форм

6.  В окне диалога Изменение элемента кнопочной фор¬мы за-полните поля:
а) Текст — здесь напишите текст, который будет находи¬ться пос-ле кнопки и пояснять, что произойдет, если щелкнуть левой клавишей 

 
Рис. 3.8. Создание новой страницы кнопочной формы
 
Рис. 3.9. Окно Изменение страницы кнопочной фор¬мы
мыши по этой кнопке. Введите «Открыть форму для добавления» (рис. 3.10);
б) Команда — здесь выберите один из предложенных ва¬риантов действия Access после щелчка левой клавишей мыши по этой кнопке
*  Перейти к кнопочной форме — Access откроет другую стра-ницу кнопочной формы, название которой Вы укажите в поле «Кно-почная форма»;
*  Открыть форму для добавления — Access откроет форму, указанную Вами в поле Форма так, что Вы не увидите ра¬нее сделанные записи и не сможете изменить их;
*  Открыть форму для изменения — Access откроет форму, указанную Вами в поле «Форма» так, что Вы сможете изме¬нять ранее сделанные записи;
*   Открыть отчет — Access откроет указанный Вами отчет. Его имя нужно будет выбрать в поле со списком «Отчет»;
*   Конструктор  приложения — на странице  появится кнопка, с помощью которой можно будет при необходимости изменить кно-почную форму;
* Выйти из приложения — Access закроет базу данных, с
которой Вы работаете;
*  Выполнить макрос — после щелчка по такой кнопке будет выполнена заранее определенная макрокоманда;
* Выполнить программу — Access запустит программу, которую Вы укажите в поле Программа.
Сейчас необходимо выбрать первую строку списка, так как нужно, чтобы Access открыл новую страницу кнопочной формы (Рис. 3.10). 
в) Имя поля — имя последнего поля зависит от того, что Вы вы-брали во втором поле. В некоторых случаях третье тюле исчезает с эк-рана. В нашем примере выберите из раскрывающегося списка Новая информация (Рис. 3.10). 
 
Рис. 3.10. Окно изменения элемента кнопочной формы
7.  Заполнив поля, щелкните по кнопке ОК.
8. Щелкните по кнопке Закрыть и нажмите на левую кла¬вишу мыши.
9. Повторите эти действия для страницы Просмотр информации кнопочной формы. 
Для создания кнопки Выход в поле Команда выберите строку Выйти из приложения.
В итоге должна получиться форма с тремя кнопками (Рис. 3.11).
Теперь на странице Новая информация, которая открывается при нажатии кнопки Открыть форму для добавления, разместим кнопки для открытия форм. 
 
Рис. 3.11. Главная кнопочная форма
1.	Выделите строку Новая информация в окне  диспетчера кно-почных форм и щёлкните по кнопке Изменить.
2.	В появившемся окне щёлкните по кнопке Создать.
3.	В поле Текст введите название формы, например, Данные о врачах. В поле Команда выберите Открыть форму для добавления. Такой режим дает возможность обезопасить себя от внесения исправ-лений в существующую информацию при вводе новой. В поле форма укажите форму Данные о врачах.
4.	 Создайте самостоятельно кнопки для открытия других форм.
 Разместите также кнопки для открытия форм на странице Про-смотр информации. При этом   поле Команда выберите Открыть форму для изменения.
На всех страницах, кроме главной  поместите кнопку для перехода к главной странице. Для этого в окне диалога Изменение элемента кнопочной Формы в поле Текст напишите Главная стра-ница, в поле со списком Команда установите Переход к кнопочной форме, в поле со списком Форма выберите строку Главная кнопочная форма.
Можно создать кнопку для редактирования главной кно¬почной формы, для этого нужно в окне диалога Изменение элемента кно-почной формы в поле текст написать Изменение главной кнопочной формы, а в поле со списком щелкнуть по строке Конструктор при-ложения.
3.3. Контрольные вопросы
1.	Пояснить  назначение  форм   и   различия   между  мастером и мастером автоформ.
2.	Каков   порядок   создания   формы    с    помощью   мастера ав-тоформ?
3.	Перечислить шаги создания формы для одной таблицы с по-мощью мастера.
4.	Как с  помощью  мастера  создания форм изменить состав полей для размещения в форме?
5.	Перечислить порядок создания формы для двух связанных таблиц (один-к-одному) и пояснить назначение каждого шага.
6.	Перечислить порядок создания формы для двух связанных таблиц (один-ко-многим) и пояснить назначение каждого шага.   
7.	Как меняется окно вывода данных в форме при изменении ро-дительской (дочерней) таблицы?
8.	Как выбирается стиль формы в мастере создания форм?
9.	Как можно запустить форму на выполнение?
3.4. Задания для самопроверки
1.	Для таблицы Данные о врачах создайте форму, в которую занесите все поля кроме поля стаж работы.
2.	Для таблицы Данные о врачах создайте форму, в которой кнопки управления содержат текстовые надписи.
3.	Для таблицы Данные о врачах создайте форму, в которой кнопки управления содержат графические изображения.
4.	Для таблицы Данные о пациентах  создайте форму с помощью мастера автоформ.
5.	Для таблицы   Данные о посещении врачей пациентами создайте форму с помощью мастера.
6.	Для таблиц Данные о пациентах и Данные о посещении врачей пациентами создайте форму, в которой таблица Данные о пациентах - родительская, a Данные о посещении врачей пациентами - дочерняя. 
7.	Для таблиц Данные о врачах и Данные о посещении врачей паци-ентами создайте форму, в которой таблица Данные о врачах - роди-тельская, a Данные о посещении врачей пациентами - дочерняя. 
